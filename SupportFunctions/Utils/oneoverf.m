function y = oneoverf(a, r, c)%% ONEOVERF - returns an array of 1/f noise%% usage:%	ONEOVERF(a, n) returns a square 2D array%	of noise with a 1/(f^a) amplitude spectum%	ONEOVERF(a, m, n) returns an m-by-n array%% see also: spike, oneoverf3d, spike3d%% Lawrence K. Cormack% history:% 11/12/2002    lkc     There seems to be an orientation bias when the array size is odd.%                       The called function spike() is centering its peak correctly vis-a-vis %                       the shifted Fourier transform, yet the bias remains... Perhaps this is%                       an inherent short coming of the fft algorithm.%                       at any rate, I'm adding a cludge to pad up to the next even pixel and %                       then trim.% 11/12/2000    lkc     cleaned it up % 3/4/01        lkc     added variable exponent% 4/1/02        lkc     exponent is now handled in spike()% 4/1/02        lkc     changed the way the spectrum is generated to the more intuitive%                       amp/phase based-method, but it makes no functional difference.% 2/19/10       tbc     changed "i" to "1i" per matlab speed suggestion% 2020-12-14    tbc     removed old dependencies, moved over to PLDAPS...Utils%  %*** deal with oddity ***codd = 0; rodd = 0;if nargin==2    c=r;endif isodd(c)	c=c+1;	codd = 1;endif isodd(r)	r=r+1;	rodd = 1;end% ******** make the noise ************************skirt = spike(a, r, c);	                            % the amp. spectrumy = skirt.*exp(1i.*2.*pi.*rand(r, c));               % noise on the complex frequency planey=normalize(real(ifft2(fftshift(y))));              % and over to the space domain.%*** deal with oddity again ***if codd % remove old dependency:  y=trimr(y, 1); end    y(:,end) = [];endif rodd % remove old dependency:  y=trimb(y, 1); end    y(end,:) = [];end%*********************************************** the endend %oneoverf% % % % % % % % % %%% Sub-functions% % % % % % % % % %%% spikefunction s=spike(alpha, r, c)%% SPIKE - 	creates a spike image, an array in which the%			value is inversely proportional to the distance%			from the center.  % % usage:%     S = SPIKE(ALPHA, R, C) produces an RxC array, the value%                           of which falls off as 1/(d^ALPHA) where d is%                           the euclidean distance from the array center.%     %     Useful for making 1/f^alpha noise images.%     % See also:  oneoverf(), spike3d(), oneoverf3d()% % Lawrence K. Cormack% history:% ??/??/2000    lkc     wrote it% 11/12/2000    lkc     updated for any rxc size% 11/12/2000    lkc     added odd/even dependent shift to compensate for the%			            location of the DC after fftshift()% 3/31/2002     lkc     added the exponent, alpha, to this function (where it belongs)%                       rather than dealing with it in oneoverf()% 4/1/2002      lkc     changed the distance computations to a more intuitive and%                       straight-forward method using meshgrid(). if nargin == 2 c=r; ends = ones(r, c); y = linspace(-r./2, r./2, r);x = linspace(-c./2, c./2, c);[X, Y] = meshgrid(x, y);dists = sqrt(X.^2 + Y.^2);s = s./dists.^alpha;end %spike